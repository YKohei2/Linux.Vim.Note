セキュリティ

3つのセキュリティ基礎..
公開鍵暗号方式..機密性
メッセージ認証コード,一方向ハッシュ関数..正真性
証明書..認証

---------------------------------------------------------------------
証明書とは..運転免許所のようなもの。個人情報、その人の公開鍵、認証局のデジタル署名のセット
認証局(CA)..システム運用者を審査して証明書を発行す機関

証明書の発行の流れ..
1.申請者はキーペアを発行する(秘密鍵は自分で保管)
2.公開鍵と所有者情報をセットで認証局に提出
3.認証局の審査開始
4.審査に通れば認証局の署名をつけて証明書発行、キーペアが完成する。

証明書失効手順..
1.秘密鍵が紛失、盗難された場合、認証局に執行の申し出
2.認証局がCRL（失効リスト)に公開鍵を追加する
3.そのキーペアはもう使えない
---------------------------------------------------------------------

SSLサーバ証明書..本物のサーバか確認できる
SSLサーバ証明書(HTTPSの場合)の流れ
1.クライアントからwebサーバに接続要求
2.webサーバがサーバ証明書をクライアントに送付
3.サーバ証明書の検証
4.正しい証明書であれば共通かぎを作って暗号化して、暗号化した鍵をwebサーバに送付
5.秘密鍵で共通鍵を復号。
7.共通鍵による暗号化通信
-------------------------------------------------

メッセージ認証コード,一方向ハッシュ関数..正真性
..電子署名を使用している。

電子署名..電子データの作成者情報を電子ファイルに添付して。電子ファイルが改ざんでないことを保証する技術。

一方向ハッシュ関数とは..
電子署名に使用される技術
対象のデータから特殊な計算によりランダムな英数字を生成する。
ハッシュから元の入力データを逆生成することは不可能
例:
リンゴ(入力データ) → ハッシュ関数 → 319sdag4werjasvt0jifjq09j4(ハッシュ値)

電子署名の仕組み..
1.署名者が電子署名を使って電子ファイルに署名をする。
2.電子ファイルのハッシュ値を計算して、所有者の秘密鍵で暗号化する。
3.電子ファイル、暗号化したハッシュ鍵、署名者の証明書の３点セットを検証者（データの送り先）に送る。
4.検証者は暗号化したハッシュ値をAさんの証明書の中にある、公開鍵で復号化する。
5.電子ファイルから出したハッシュ値と暗号化されていたハッシュ値を比較する。
6ハッシュ値の比較結果が一致すれば署名者が作成し改ざんできていないことが証明できる。
ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー
暗号化プロトコル
SSL:　暗号化プロトコル
TLS: SSLの後継的暗号化プロトコル。SSL/TLSと表記されることが多い

SSL/TLSは下記などと組み合わせて使われる。

HTTPS = HTTP + SSL/TLS
SMTPs = SMTP + SSL/TLS
POP3s = POP3 + SSL/TLS
IMAPs = IMAP + SSL/TLS

暗号化スイートとは..
暗号化通信の種類とアルゴリズムの組み合わせ
アルゴリズム..RSA, AES128, SHA-256.ECDHE


暗号化スイートの例:
:TLS_ECDHE(鍵交換)_RSA(認証)_WITH_AES_128(共通鍵暗号)_CBC_SHA256(ハッシ)
     
-----------------------------------------------------------------


IDS..OS、ソフトウェア、ネットワークの保護
..不正なアクセスがないかをリアルタイムでチェック,検知したら管理者に通知

IPS.. OS, ソフトウェア、ネットワークの保護
..不正なアクセスがないかをリアルタイムでチェック,検知したら遮断

IDS/IPSの種類
ネットワーク型..ネットワークでチェック,通信パケットの中身を監視
ホスト型..インストールしてサーバ上でチェック、ログファイルやファイルの改ざんを監視する

-----

WAF..webアプリケーションの保護
..アプリケーションの脆弱性をついた攻撃をブロック

WAFの種類
ソフトウェア型..Webサーバにインストールして使用する(簡単にスタートできる)
アプライアンス型..専用の機器を設置して,webアプリケーションの手前に設置する(柔軟にカスタマイズできる)
クラウド型..ベンダーからクラウド上でサービスを受ける(初期費用抑えられる。メンテナンスを任せられる)

----
ファイアーウォール..ネットワークに対する攻撃を保護する。IPアドレス,ポート番号を見て通過か遮断か判断する
WAF,ファイアーウォールは役割が違うのでどちらも必要

----------------------------------------------------
DoS攻撃(サービス拒否攻撃)..
標的などに対して大量のパケットを送りつけること

DDos攻撃(分散が阿多サービス拒否攻撃)..
標的などに対して複数のコンピュータ(関係のない踏み台サーバ)からDoS攻撃


Dos攻撃の種類

第3,4層(ネットワーク、トランスポート)
SYN floods (トランスポート)
UDP reflection attacks (ネットワーク)
サーバやネットワークの負荷を増大させる

第6,7層(プレゼンテーション、アプリケーション)
HTTP floods, DNS query floods (アプリケーション)
SSL abuse (プレゼンテーション)
ログインページを攻撃してユーザのログインできないようにする。


UDP reflection attacks..
送信元IP(ターゲット)を偽ってDNS問い合わせを行うことで、DNSサーバが攻撃対象に応答パケットを送る攻撃してサーバが機能不能になる。
ターゲットからするとDNSサーバが攻撃しているように見える。


SYN floods..
TCPの3wayハンドシェイクを利用して第一段階のSYNパケットを送信元IPを偽って連続して送信する攻撃。（送信元IPを偽装しているためAKCパケットが完結せずリソースを消費させてサーバがダウン)
 * 3wayハンドシェイク..TCPのやり取りをする際に、SYNパケット(TCPのやり取りをするリクエスト)を送って,
 送られた側はACKパケット(承認)を返してTCPのやり取りをスタートさせる.
 

HTTP floods..
不正にインストールした複数Botを使って大量のHTTPリクエスト送信する攻撃してアクセスを増やす。
そのためクライアントはそのサーバにアクセスできなくなる


SSL abuse (SSL Stripe)..
Attackerがサーバとターゲットの間に入りサーバとはhttpsで通信をするが、ターゲットとは間に入って偽のhttpで
つなげてターゲットの個人情報などAttackerに入るようにする。

DNS query floods..
1つまたは複数のDNSサーバに大量のリクエストを送信することで正当のユーザからのリクエストを妨害する。